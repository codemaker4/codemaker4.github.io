<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>catancalc</title>
  </head>
  <body>
    <table style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; height: 100%; width: 100%;">
      <tr>
        <td style="height: 50%; width: 50%"><button type="button" id="activate" style="height: 100%; width: 100%; backGround-color: #0F0; font-size: 10vw;" onclick="activateBuilding();">activeren</button></td>
        <td style="height: 50%; width: 50%"><button type="button" id="check" style="height: 100%; width: 100%; backGround-color: #F00; font-size: 10vw;" onclick="check();">controleren</button></td>
      </tr>
      <tr>
        <td style="height: 50%; width: 50%"><button type="button" id="startRounds" style="height: 100%; width: 100%; background-color: #00F; font-size: 10vw;" onclick="startRounds();">start rondes</button></td>
        <td style="height: 50%; width: 50%"><button type="button" id="random" style="height: 100%; width: 100%; background-color: #FF0; font-size: 10vw;" onclick="doRandom();">random</button></td>
      </tr>
    </table>
  </body>
  <script type="text/javascript">
    var activatedBuildings = [];
    class activatedBuilding {
      constructor(id, rpr) {
        this.id = id;
        this.resourcesPerRound = rpr;
        this.unusedResources = 0;
      }
    }
    function activateBuilding() {
      id = prompt("geef de ID van het nieuwe gebouw.")
      if (id === null) {
        return;
      }
      var foundBuilding = false;
      for (var i = 0; i < activatedBuildings.length; i++) {
        if (activatedBuildings[i].id == id) {
          foundBuilding = true;
          break;
        }
      }
      if (!foundBuilding) {
        var rpr = prompt('hoeveel grondstoffen per ronde?')
        if (id === null) {
          return;
        }
        activatedBuildings.push(new activatedBuilding(id, parseFloat(rpr)));
      } else {
        alert('Dit gebouw is al geactiveerd.');
      }
    }

    function check() {
      id = prompt("geef de ID van het gebouw.")
      if (id === null) {
        return;
      }
      var foundBuilding = false;
      for (var i = 0; i < activatedBuildings.length; i++) {
        if (activatedBuildings[i].id == id) {
          alert("Dit gebouw heeft " + Math.floor(activatedBuildings[i].unusedResources).toString() + " grondstoffen.");
          activatedBuildings[i].unusedResources = activatedBuildings[i].unusedResources%1;
          foundBuilding = true;
          break;
        }
      }
      if (!foundBuilding) {
        alert("Gebouw '" + id + "' bestaat niet of is nog niet geactiveerd.");
      }
    }

    var doRoundInterval
    function startRounds() {
      var secs = prompt("geef ronde tijd in secondes");
      if (parseInt(secs)*1000) {
        clearInterval(doRoundInterval);
        doRoundInterval = setInterval(doRound, parseInt(secs)*1000);
      }
    }
    function doRound() {
      console.log('round');
      for (var i = 0; i < activatedBuildings.length; i++) {
        activatedBuildings[i].unusedResources += activatedBuildings[i].resourcesPerRound;
      }
    }

    var randomResetTimeout;
  	function doRandom() {
      clearTimeout(randomResetTimeout);
      if (Math.random() < 0.5) {
        document.getElementById('random').style.backgroundColor = '#F00';
      } else {
        document.getElementById('random').style.backgroundColor = '#0F0';
      }
      randomResetTimeout = setTimeout(function(){document.getElementById('random').style.backgroundColor = '#FF0';}, 1000);
    }
  </script>
</html>
